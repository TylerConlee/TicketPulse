{{define "content"}}
<h1>Profile</h1>

<h2>Daily Summary Settings</h2>
<form method="POST" action="/profile/update-summary-settings">
    <div class="form-group">
        <label for="daily_summary">Enable Daily Summary:</label>
        <input type="checkbox" id="daily_summary" name="daily_summary" {{if .User.DailySummary}}checked{{end}}>
    </div>
    <div class="form-group">
        <label for="summary_time">Summary Time:</label>
        <input type="time" id="summary_time" name="summary_time" value="{{.User.SummaryTime.Format "15:04"}}" required>
    </div>
    <button type="submit" class="btn btn-primary">Update Settings</button>
</form>

<hr>

<h2>Tag Alerts</h2>
<form method="POST" action="/profile/add-tag">
    <div class="form-group">
        <label for="tag">Tag:</label>
        <input type="text" name="tag" id="tag" required class="form-control">
    </div>
    <div class="form-group">
        <label for="slack_channel">Slack Channel:</label>
        <select name="slack_channel" id="slack_channel" required class="form-control">
            {{range .SlackChannels}}
            <option value="{{.ID}}">{{.Name}}</option>
            {{end}}
        </select>
    </div>
    <div class="form-group">
        <label for="alert_type">Alert Type:</label>
        <select name="alert_type" id="alert_type" required class="form-control">
            <option value="new_ticket">New Ticket</option>
            <option value="sla_deadline">SLA Deadline</option>
            <option value="ticket_update">Ticket Update</option>
        </select>
    </div>
    <button type="submit" class="btn btn-primary">Add Tag Alert</button>
</form>

<h2>Configured Alerts</h2>
<table class="table">
    <thead>
        <tr>
            <th>Tag</th>
            <th>Slack Channel</th>
            <th>Alert Type</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        {{range .TagAlerts}}
        <tr>
            <td>{{.Tag}}</td>
            <td>{{.SlackChannelID}}</td>
            <td>{{.AlertType}}</td>
            <td>
                <form method="POST" action="/profile/delete-tag/{{.ID}}" onsubmit="return confirm('Are you sure you want to delete this alert?');">
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
            </td>
        </tr>
        {{end}}
    </tbody>
</table>
{{end}}
